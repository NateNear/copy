{"/":{"title":"Jacobian Matrix","data":{"":"Jacobian Matrix\n\r\n    clc\r\nnbus=3; sb=1;\r\nv=[1.0 1.0 1.0];delta=[0 0 0]\r\nyb=[65-j*45 -40+j*20 -25+j*25\r\n    -40+j*20 60-j*60 -20+j*40\r\n    -25+j*25 -20+j*40 45-j*65]\r\nym=sqrt(real(yb).^2+imag(yb).^2)\r\nangle=atan2(imag(yb),real(yb))\r\nclear J\r\n% computation of diagonal elements of J1 to J4\r\nfor i=1:nbus\r\nJ1(i,i)=0.0;J3(i,i)=0.0;J22=0;J44=0;\r\nfor j=1:nbus\r\nif j~=i\r\n            J1(i,i)=J1(i,i)+v(i)*v(j)*ym(i,j)*sin(angle(i,j)-delta(i)+delta(j));\r\n            J3(i,i)=J3(i,i)+v(i)*v(j)*ym(i,j)*cos(angle(i,j)-delta(i)+delta(j));\r\n            J22=J22+v(j)*ym(i,j)*cos(angle(i,j)-delta(i)+delta(j));\r\n             J44=J44+v(j)*ym(i,j)*sin(angle(i,j)-delta(i)+delta(j));            \r\nend\r\nend\r\nif i~=sb\r\nJ1(i,i)=J1(i,i);\r\nJ3(i,i)=J3(i,i);\r\n          J2(i,i)=2*v(i)*ym(i,i)*cos(angle(i,i))+J22;\r\nJ4(i,i)=-2*v(i)*ym(i,i)*sin(angle(i,i))-J44;\r\nend\r\nend\r\n% computation of OFF diagonal elements of J1 to J4\r\nfor i=1:nbus\r\nfor j=1:nbus\r\nif (j~=i) & (i~=sb) & (j~=sb)\r\n            J1(i,j)=-v(i)*v(j)*ym(i,j)*sin(angle(i,j)-delta(i)+delta(j));\r\n            J2(i,j)=v(i)*ym(i,j)*cos(angle(i,j)-delta(i)+delta(j));\r\n            J3(i,j)=-v(i)*v(j)*ym(i,j)*cos(angle(i,j)-delta(i)+delta(j));\r\n            J4(i,j)=-v(i)*ym(i,j)*sin(angle(i,j)-delta(i)+delta(j));\r\nend\r\nend\r\nend\r\n%arrangement of jacobian matrix\r\nfor i=1:nbus\r\nfor j=1:nbus\r\nif i~=sb& j~=sb\r\nJ(i-1,j-1)=J1(i,j);\r\nJ(i-1,j+nbus-2)=J2(i,j);\r\nJ(i+nbus-2,j-1)=J3(i,j);\r\nJ(i+nbus-2,j+nbus-2)=J4(i,j);\r\nend\r\nend\r\nend\r\nJ"}},"/non_salient":{"title":"non-salient","data":{"":"non-salient\nclear all\r\nclc\r\nj=sqrt(-1);\r\nvt=34.64*(10^3);\r\np=48*(10^6);\r\npf=0.8;\r\nxs=10;\r\nvtph=vt/(sqrt(3));\r\nphi=acos(pf);\r\nq=p*tan(phi);\r\ni=(p-j*q)/(3*vtph);\r\ne=vtph+ (j*i*xs);\r\nef=abs(e)\r\ndelta=0:1:180;\r\ndel=(delta*3.142)/180;\r\np1=(vtph*ef*sin(del))/xs;\r\nreg=((ef-vtph)/vtph)*100\r\nplot(delta,p1)"}},"/salient":{"title":"salient","data":{"":"salient\nclear all\r\nclc\r\nj=sqrt(-1);\r\nvt=34.64*(10^3);\r\np=48*(10^6);\r\npf=0.8;\r\nxd=13.5;\r\nxq=9.33;\r\nvtph=vt/(sqrt(3));\r\nphi=acos(pf);\r\nq=p*tan(phi);\r\ni=(p-j*q)/(3*vtph);\r\ne=vtph+ (j*i*xq);\r\nid=(abs(i)+sin(angle(e)-angle(i)));\r\nef=abs(e)+((xd-xq)*id)\r\ndelta=0:1:180;\r\ndel=(delta*3.142)/180;\r\np1=(vtph*ef*sin(del))/xd;\r\np2=((vtph^2)*(xd-xq)*sin(2*del))/(2*xd*xq);\r\np3=p1+p2\r\nreg=((ef-vtph)/vtph)*100\r\nplot(delta,p3,delta,p1,delta,p2)"}},"/with_coupling":{"title":"with coupling","data":{"":"with-coupling\nclear all\r\nclc\r\nzd=[1 2 0 0.6;1 3 0 0.5;3 4 0 0.5;1 2 0 0.4;2 4 0 0.2];\r\nzm=[1 2 0 0.1;1 4 0 0.2];\r\nn=4;\r\ne=5;\r\nnm=2;\r\nsn=zd(:,1);\r\nen=zd(:,2);\r\nr=zd(:,3);\r\nx=zd(:,4);\r\nz=r+(j*x);\r\nsm=zm(:,1);\r\nem=zm(:,2);\r\nrm=zm(:,3);\r\nxm=zm(:,4);\r\nzm=rm+(j*xm);\r\na=zeros(e,n);\r\nfor i=1:e\r\n    a(i,sn(i))=1;\r\n    a(i,en(i))=-1;\r\nend\r\na(:,1)=[];\r\n\r\nzpri=zeros(e,e);\r\nfor k=1:e\r\n    zpri(k,k)=z(k);\r\nend\r\n\r\nfor l=1:nm\r\n    zpri(sm(l),em(l))=zm(l);\r\n    zpri(em(l),sm(l))=zm(l);\r\nend\r\nypri=inv(zpri);\r\nybus=a' * ypri * a;\r\ndisp(ybus)"}},"/without_coupling":{"title":"without coupling","data":{"":"without-coupling\nclear all\r\nclc\r\nj=sqrt(-1);\r\nzd=[1 2 0 0.2 0 -6.66; 1 3 0 0.15 0 0;1 4 0 0.1 0 0;2 3 0 0.1 0 0;2 4 0 0.15 0 0];\r\nn=4;\r\nl=5;\r\ne=n+l;\r\nsn=zd(:,1);\r\nen=zd(:,2);\r\nr=zd(:,3);\r\nx=zd(:,4);\r\ngsh=zd(:,5);\r\nbsh=zd(:,6);\r\nysh=gsh+(j*bsh);\r\nz=r+(j*x);\r\ny=1./z;\r\nA=zeros(e,n);\r\nfor i=1:n\r\n    A(i,i)=1;\r\nend\r\nfor i=1:l\r\n    A(n+i,sn(i))= 1;\r\n    A(n+i,en(i))= -1;\r\nend\r\nypri=zeros(e,e);\r\nfor i=1:l\r\n    ypri(n+i,n+i)=y(i);\r\n    ypri(sn(i),sn(i))=ypri(sn(i),sn(i))+ysh(i);\r\n    ypri(en(i),en(i))=ypri(sn(i),sn(i))+ysh(i);\r\nend\r\nybus=A'*ypri*A;\r\ndisp(ybus)"}},"/swing_curve":{"title":"swing curve","data":{"":"sing-curve\nclear all\r\nclc\r\nh=2.52;\r\nxpre=0.45;\r\nxpost=0.55;\r\nxfault=1.25;\r\ne=1.1;\r\nv=1.0;\r\nmva=20;\r\nmw=18;\r\ndelta=21.64;\r\ntc=0.125;\r\ntfinal=0.5;\r\nm=h/(180*50);\r\npm=mw/mva;\r\nppre=e*v/xpre;\r\npfault=e*v/xfault;\r\nppost=e*v/xpost;\r\nddelta=0;\r\npi=3.142;\r\ntstep=0.005;\r\nt=0;\r\ntf=0;\r\ni=2;\r\ntime(1)=0;\r\nang(1)=delta;\r\nwhile (t<tfinal)\r\n    if(t==tf)\r\n        paa=pm-ppre*sin(delta*pi/180);\r\n        pab=pm-pfault*sin(delta*pi/180);\r\n        pa=(paa+pab)/2;\r\n    end\r\n    if(t>tf & t<tc)\r\n        pa=pm-pfault*sin(delta*pi/180);\r\n    end\r\n    if(t>tc)\r\n        pa=pm-ppost*sin(delta*pi/180);\r\n    end\r\n    ddelta=ddelta+(tstep*tstep*pa/m);\r\n    delta=delta+ddelta;\r\n    t=t+tstep;\r\n    time(i)=t;\r\n    ang(i)=delta;\r\n    i=i+1;\r\nend\r\nplot(time,ang)"}},"/zbus_building_algo":{"title":"zbus building algo","data":{"":"zbus-building-algo\nclear all\r\nclc\r\nzdata=[1 1 0 0.25; 2 2 1 0.1; 3 3 1 0.1;4 2 0 0.25;5 2 3 0.1];\r\nzbus=[];\r\ncbn=0;\r\n[ro co]=size(zdata);\r\nfor i=1:ro\r\n    [ro1 co1]=size(zbus);\r\n    sb=zdata(i,2);\r\n    eb=zdata(i,3);\r\n    zser=zdata(i,4);\r\n    newbus=max(sb,eb);\r\n    ref=min(sb,eb);\r\n\r\n    %type1\r\n    if newbus>cbn & ref==0\r\n        zbus=[zbus zeros(ro1,1); zeros(1,co1) zser];\r\n        cbn=newbus;\r\n        continue\r\n    end\r\n\r\n    %type2\r\n    if newbus>cbn & ref~=0\r\n        zbus=[zbus zbus(:,ref)\r\n            zbus(ref,:) zser+zbus(ref,ref)];\r\n        cbn=newbus;\r\n        continue\r\n    end\r\n\r\n    %type3\r\n    if newbus<=cbn & ref==0\r\n        zbus= zbus-1/(zbus(newbus,newbus)+zser)*zbus(:,newbus)*zbus(newbus,:);\r\n        continue\r\n    end\r\n\r\n    %type4\r\n    if newbus<=cbn & ref~=0\r\n        zbus=zbus-1/(zser+zbus(sb,sb)+zbus(eb,eb)-2*zbus(sb,eb))*((zbus(:,sb)-zbus(:,eb))*((zbus(sb,:))-zbus(eb,:)));\r\n        continue\r\n    end\r\nend\r\ndisp(j*zbus)"}}}